[gcode_macro M73]
rename_existing: M73.1
gcode:
  {% set NUM_LAYERS = printer["gcode_macro PREP_PRINT"].num_layers %}
  {% set CUR_LAYER = printer["gcode_macro PREP_PRINT"].cur_layer %}
  {% set TOOL_CHANGES = printer["gcode_macro PREP_PRINT"].tool_changes %}
  {% if params.R %}
    M117 { "%02d:%02d" % (params.R|int // 60, (params.R|int) % 60) } remaining  Layer {CUR_LAYER|int} of {NUM_LAYERS|int}
  {% elif params.C %}
    M117 Color {params.C} of {TOOL_CHANGES}
  {% elif params.Q %}
    M117 { "%02d:%02d" % (params.S|int // 60, (params.S|int) % 60) } remaining  Layer {CUR_LAYER|int} of {NUM_LAYERS|int}
  {% else %}
    M117 Printing
  {% endif %}