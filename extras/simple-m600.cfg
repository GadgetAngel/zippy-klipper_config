[gcode_macro PARK_MACRO]
gcode:
  {% set X = params.X|default(0)|float %}
  {% set Y = params.Y|default(0)|float %}
  {% set Z = params.X|default(30)|float %}
  M117 PARKING..
  G91
  G1 E-3.14 F1500
  G1 Z{Z}
  G90
  G1 X{X} Y{Y} F3000


# Edit the default() value for LENGTH
# to the amount of retraction required to unload the filament
[gcode_macro UNLOAD]
gcode:
  {% set LENGTH = params.LENGTH|default(80)|float %}

  {% if printer.configfile.config.extruder.min_extrude_temp is defined %}
    {% set TARGET = printer.configfile.config.extruder.min_extrude_temp|float %}
  {% else %}
    {% set TARGET = 180.0 %}
  {% endif %}

  {% set TEMP = printer.extruder.temperature|float %}

  {% if TEMP|int < TARGET|int %}
    M117 Heating nozzle...
    M109 S{TARGET}
  {% endif %}
  
  G91
  G1 E5.0 F1200
  G1 E3.0 F1600
  G1 E-13.14 F7000
  G1 E-{LENGTH} F3000
  G90

[gcode_macro M600]
gcode:
  PAUSE_MACRO
  UNLOAD

[gcode_macro PAUSE_MACRO]
gcode:
  PAUSE
  PARK_MACRO
  SET_IDLE_TIMEOUT TIMEOUT=7200

[gcode_macro PURGE]
gcode:
  M117 PURGING..
  G91
  G1 E45.0 F250
  G90

# # Edit the default() value for FAST
# to the amount of extrusion required to bring the filament to
# just before it starts coming out the hotend

# # Edit the default() value for SLOW
# to the amount of extrusion required after it reaches the hotend

[gcode_macro LOAD_FILAMENT]
gcode:
  {% set SLOW = params.SLOW|default(60)|float %}
  {% set FAST = params.FAST|default(100)|float %}
  M117  LOADING...
  G91
  G1 E25.0 F1000
  G1 E{FAST} F2500
  G4 P900
  G1 E{SLOW} F250
  G90

[gcode_macro RESUME_MACRO]
gcode:
  M117  RESUMING...
  RESUME